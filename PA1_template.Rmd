---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---

```{r setoptions, echo=FALSE, warning = FALSE}
library(knitr)
opts_chunk$set(echo = TRUE, 
               warning = FALSE,
               message = FALSE)
```

## Loading and preprocessing the data

```{r preprocess}
unzip("activity.zip")
activity <- read.csv("activity.csv")
```


## What is mean total number of steps taken per day?

### Summarize by date

Group the data by date and compute the sum of steps taken per day. For this computation, NAs were removed. 
Column `interval` is not relevant for this summary, so we use the special `summarise_each_()` function to exclude it.

```{r stepsPerDay}
library(dplyr)
groupByDay <- group_by(activity, date) 
stepsPerDay <- 
    summarise_each_(groupByDay, 
                    funs(sum(., na.rm = TRUE)), 
                    list(quote(-interval)))
```


### Histogram of steps per day

```{r histogramStepsPerDay}
library(ggplot2)
qplot(steps, data = stepsPerDay,
      main = "Histogram of steps per day",
      fill = I("wheat"),
      col = I("black"))
```


### Mean and median of steps per day

```{r meanAndMedian}
meanStepsPerDay <- mean(stepsPerDay$steps)
medianStepsPerDay <- median(stepsPerDay$steps)
```

Of the total number of steps taken per day, the mean is `r meanStepsPerDay` and the median is `r medianStepsPerDay`.


## What is the average daily activity pattern?

### Compute the average by interval

Group the data by interval and compute the mean of steps. For this computation, NAs were removed.
Column `date` is not relevant for this summary, so we use the special `summarise_each_()` function to exclude it.

```{r dataDailyAverage}
groupByInterval <- group_by(activity, interval)
meanByInterval <- 
    summarise_each_(groupByInterval, 
                    funs(mean(., na.rm = TRUE)), 
                    list(quote(-date)))
names(meanByInterval)[2] <- "meanSteps"
```


### Time series plot

```{r plotDailyAverage}
qplot(interval, meanSteps, 
      data = meanByInterval, 
      geom = "line",
      main = "Daily average number of steps taken by interval",
      ylab = "Daily average number of steps")
```


### Maximum number of steps from the daily average

```{r maxStepsDailyAverage}
maxStepsDailyAverage <- meanByInterval[which.max(meanByInterval$meanSteps), 1]
```

On average across all the days in the dataset, the interval `r maxStepsDailyAverage` contains the maximum number of steps.


## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
